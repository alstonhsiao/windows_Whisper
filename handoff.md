# Windows 10 èªéŸ³è½‰æ–‡å­—å·¥å…· â€” å¯¦ä½œäº¤æ¥æ–‡ä»¶

> **å»ºç«‹æ—¥æœŸï¼š** 2026-02-12
> **ç›®çš„ï¼š** å°‡ macOS ä¸Šçš„ã€ŒæŒ‰ä½ç†±éµ â†’ éŒ„éŸ³ â†’ OpenAI Whisper API â†’ è²¼ä¸Šæ–‡å­—ã€åŠŸèƒ½ç§»æ¤åˆ° Windows 10
> **æœ¬æ–‡ä»¶ç‚ºè‡ªè¶³æ–‡ä»¶ï¼ŒåŒ…å«æ‰€æœ‰å¯¦ä½œæ‰€éœ€çš„èƒŒæ™¯çŸ¥è­˜èˆ‡æŠ€è¡“ç´°ç¯€**

---

## ä¸€ã€èƒŒæ™¯èˆ‡åŸå§‹éœ€æ±‚

### åŸå§‹åŠŸèƒ½æè¿°ï¼ˆmacOS ç‰ˆï¼‰

åœ¨ macOS ä¸Šé€é Keyboard Maestro è‡ªå‹•åŒ–å·¥å…·å¯¦ç¾çš„èªéŸ³è½‰æ–‡å­—åŠŸèƒ½ï¼š

1. **æŒ‰ä½ F1** â†’ é–‹å§‹éŒ„éŸ³ï¼ˆä½¿ç”¨ SoX çš„ `rec` æŒ‡ä»¤ï¼‰
2. éŒ„éŸ³é–‹å§‹å¾Œç™¼å‡º **ç³»çµ± beep æç¤ºéŸ³**ï¼ˆå‘ŠçŸ¥ä½¿ç”¨è€…å¯ä»¥é–‹å§‹èªªè©±ï¼‰
3. **æ”¾é–‹ F1** â†’ åœæ­¢éŒ„éŸ³
4. è‡ªå‹•å°‡éŒ„éŸ³æª”é€å¾€ **OpenAI Whisper API** é€²è¡ŒèªéŸ³è¾¨è­˜
5. å–å¾—è¾¨è­˜çµæœå¾Œé€²è¡Œ **Regex ä¿®æ­£**ï¼ˆå°ˆæœ‰åè©æ ¡æ­£ï¼‰
6. **Trim ç©ºç™½** å¾Œä»¥æ¨¡æ“¬è²¼ä¸Šæ–¹å¼æ’å…¥æ–‡å­—åˆ°ç•¶å‰æ¸¸æ¨™ä½ç½®

### ä½¿ç”¨æƒ…å¢ƒ

- æ—¥å¸¸å·¥ä½œä¸­å¿«é€Ÿè¼¸å…¥ä¸­æ–‡ï¼ˆç¹é«”ï¼‰
- æœƒè­°è¨˜éŒ„ã€è¨Šæ¯å›è¦†ã€æ–‡ä»¶æ’°å¯«
- éœ€è¦æ­£ç¢ºè¾¨è­˜äººåã€å…¬å¸åã€æŠ€è¡“åè©ç­‰å°ˆæœ‰åè©

---

## äºŒã€åŸå§‹ macOS å¯¦ä½œçš„å®Œæ•´æŠ€è¡“ç´°ç¯€

> **ä»¥ä¸‹æ‰€æœ‰ç´°ç¯€éƒ½æ˜¯ Windows ç‰ˆæœ¬å¯¦ä½œçš„åƒè€ƒä¾æ“š**

### 2.1 éŒ„éŸ³åƒæ•¸ï¼ˆSoX `rec`ï¼‰

```bash
rec -q -c 1 -b 16 -r 16000 /tmp/my_voice.wav
```

| åƒæ•¸ | å€¼ | èªªæ˜ |
|------|-----|------|
| `-q` | â€” | éœé»˜æ¨¡å¼ï¼ˆä¸è¼¸å‡ºé€²åº¦è³‡è¨Šï¼‰ |
| `-c 1` | 1 | å–®è²é“ (Mono) |
| `-b 16` | 16 | 16-bit PCM å–æ¨£æ·±åº¦ |
| `-r 16000` | 16000 | å–æ¨£ç‡ 16kHzï¼ˆWhisper æ¨¡å‹çš„æ¨™æº–è¦æ ¼ï¼‰ |
| è¼¸å‡ºæ ¼å¼ | WAV | ç„¡å£“ç¸® WAV æª”æ¡ˆ |

**é‡è¦ï¼š** é€™äº›éŒ„éŸ³è¦æ ¼æ˜¯ Whisper API çš„æœ€ä½³è¼¸å…¥æ ¼å¼ã€‚Windows ç‰ˆæœ¬æ‡‰ç¶­æŒç›¸åŒè¦æ ¼ã€‚

### 2.2 éŒ„éŸ³å•Ÿå‹•é€šçŸ¥ï¼ˆBeepï¼‰

éŒ„éŸ³ä¸æ˜¯ç¬é–“å•Ÿå‹•çš„ï¼ŒmacOS ç‰ˆæœ¬æœ‰ä¸€å€‹é©—è­‰æ©Ÿåˆ¶ï¼š

```
éŒ„éŸ³é–‹å§‹ â†’ æ¯ 50ms æª¢æŸ¥ WAV æª”æ¡ˆå¤§å°
â†’ ç•¶æª”æ¡ˆå¤§å° > 4096 bytes æ™‚ï¼Œç™¼å‡ºç³»çµ± beep è²
â†’ ä½¿ç”¨è€…è½åˆ° beep å¾Œé–‹å§‹èªªè©±
â†’ æœ€å¤šç­‰å¾… 3 ç§’ (60 æ¬¡ Ã— 50ms)ï¼Œè¶…æ™‚å‰‡ä¸ç™¼ beep
```

**ç‚ºä»€éº¼éœ€è¦ beepï¼š**
- é¿å…ä½¿ç”¨è€…åœ¨éŒ„éŸ³ç¨‹å¼å°šæœªå°±ç·’æ™‚å°±é–‹å§‹èªªè©±
- 4096 bytes æ˜¯ WAV header + å°‘é‡éœéŸ³æ•¸æ“šï¼Œä»£è¡¨éŒ„éŸ³å·²ç¢ºå¯¦é–‹å§‹
- **Windows ç‰ˆæœ¬å¿…é ˆå¯¦ä½œç­‰æ•ˆçš„æç¤ºéŸ³æ©Ÿåˆ¶**

**Windows ç­‰æ•ˆæ–¹å¼ï¼š**
- AutoHotkey: `SoundBeep 1000, 200`ï¼ˆ1000Hz, 200msï¼‰
- Python: `winsound.Beep(1000, 200)` æˆ– `winsound.MessageBeep()`
- PowerShell: `[System.Media.SystemSounds]::Beep.Play()`

### 2.3 åœæ­¢éŒ„éŸ³

```bash
killall -2 rec    # ç™¼é€ SIGINTï¼ˆç­‰åŒ Ctrl+Cï¼‰
sleep 0.2         # ç­‰å¾… 0.2 ç§’ç¢ºä¿ WAV header å¯«å…¥å®Œæˆ
```

**ç‚ºä»€éº¼ç”¨ SIGINTï¼ˆ-2ï¼‰è€Œé SIGTERMï¼š**
- SoX çš„ `rec` æ”¶åˆ° SIGINT æœƒæ­£ç¢ºå¯«å…¥ WAV header å¾Œæ‰çµæŸ
- å¦‚æœç”¨ SIGTERM/SIGKILLï¼ŒWAV æª”æ¡ˆå¯èƒ½æå£ï¼ˆheader ä¸å®Œæ•´ï¼‰

**Windows ç­‰æ•ˆæ–¹å¼ï¼ˆé‡è¦çš„æŠ€è¡“ç´°ç¯€ï¼‰ï¼š**
- `taskkill /PID <pid>` â€” æ­£å¸¸çµ‚æ­¢ï¼ŒSoX é€šå¸¸æœƒæ­£ç¢ºæ”¶å°¾
- `taskkill /F /PID <pid>` â€” å¼·åˆ¶çµ‚æ­¢ï¼Œå¯èƒ½å°è‡´ WAV æå£ï¼ˆä¸å»ºè­°ï¼‰
- å¦‚æœ WAV æå£ï¼Œå¯åœ¨åœæ­¢å¾Œç”¨ ffmpeg ä¿®å¾©ï¼š`ffmpeg -i broken.wav -c copy fixed.wav`
- **Python æ–¹æ¡ˆï¼ˆsounddeviceï¼‰ä¸æœƒæœ‰æ­¤å•é¡Œ**ï¼Œå› ç‚ºéŒ„éŸ³è³‡æ–™åœ¨è¨˜æ†¶é«”ä¸­ï¼Œæ‰‹å‹•å¯«å…¥ WAV

### 2.4 OpenAI Whisper API å‘¼å«

**ç«¯é»ï¼š**
```
POST https://api.openai.com/v1/audio/transcriptions
```

**å®Œæ•´ curl æŒ‡ä»¤ï¼ˆmacOS åŸç‰ˆï¼‰ï¼š**
```bash
curl "https://api.openai.com/v1/audio/transcriptions" \
  -s -f \
  -H "Authorization: Bearer <API_KEY>" \
  -H "Content-Type: multipart/form-data" \
  -F file="@/tmp/my_voice.wav" \
  -F model="whisper-1" \
  -F language="zh" \
  -F temperature="0.0" \
  -F response_format="json" \
  -F prompt="<PROMPT_TEXT>"
```

**API åƒæ•¸è©³è§£ï¼š**

| åƒæ•¸ | å€¼ | å¿…è¦ | èªªæ˜ |
|------|-----|------|------|
| `file` | éŸ³è¨Šæª”æ¡ˆ | âœ… | æ”¯æ´ wav, mp3, m4a, flac, ogg ç­‰ï¼›æœ€å¤§ 25MB |
| `model` | `whisper-1` | âœ… | OpenAI çš„ Whisper æ¨¡å‹ |
| `language` | `zh` | å¦ï¼ˆå»ºè­°åŠ ï¼‰ | ISO-639-1 èªè¨€ç¢¼ï¼Œå¼·åˆ¶ä¸­æ–‡è¾¨è­˜ï¼Œæå‡æº–ç¢ºåº¦å’Œé€Ÿåº¦ |
| `temperature` | `0.0` | å¦ | 0 = æœ€ç²¾ç¢ºçµæœï¼ˆä¸å¼•å…¥éš¨æ©Ÿæ€§ï¼‰ |
| `response_format` | `json` | å¦ | å›å‚³ JSON æ ¼å¼ `{"text": "..."}` |
| `prompt` | è¦‹ä¸‹æ–¹ | å¦ | è©å½™å¼•å°æç¤ºï¼Œæœ€å¤š 224 tokens |

**curl æ——æ¨™ï¼š**
- `-s`ï¼šéœé»˜æ¨¡å¼ï¼ˆä¸é¡¯ç¤ºé€²åº¦æ¢ï¼‰
- `-f`ï¼šå¤±æ•—æ™‚å›å‚³éé›¶ exit codeï¼ˆä¾¿æ–¼éŒ¯èª¤è™•ç†ï¼‰

**API å›æ‡‰æ ¼å¼ï¼š**
```json
{
  "text": "è¾¨è­˜å‡ºçš„æ–‡å­—å…§å®¹"
}
```

**è²»ç”¨ï¼š** $0.006 USD / åˆ†é˜ï¼ˆæ¥µä½æˆæœ¬ï¼‰

### 2.5 Promptï¼ˆè©å½™å¼•å°ï¼‰

**é è¨­ Prompt å…§å®¹ï¼š**
```
è«‹ä½¿ç”¨ç¹é«”ä¸­æ–‡ã€‚åŒ…å«ï¼šè•­æ·³äº‘, å‘¨èŠ·è“, åˆä½œå» å•†åŠ æ¨¡, å°ˆæ¡ˆ Tahoe, n8n, Zeaburã€‚
```

**Prompt çš„ä½œç”¨ï¼š**
- `è«‹ä½¿ç”¨ç¹é«”ä¸­æ–‡` â€” å¼·åˆ¶ Whisper è¼¸å‡ºç¹é«”ä¸­æ–‡ï¼ˆå¦å‰‡å¯èƒ½è¼¸å‡ºç°¡é«”ï¼‰
- `åŒ…å«ï¼š...` â€” æä¾›å°ˆæœ‰åè©åƒè€ƒï¼Œå¹«åŠ© Whisper æ­£ç¢ºè¾¨è­˜äººåã€å…¬å¸åã€æŠ€è¡“åè©

**Prompt é™åˆ¶ï¼ˆOpenAI Whisper APIï¼‰ï¼š**
- æœ€å¤§é•·åº¦ï¼š224 tokensï¼ˆç´„ 150-200 å€‹ä¸­æ–‡å­—ï¼‰
- ç”¨é€”æ˜¯æä¾›è©å½™æ‹¼å¯«æŒ‡å°ï¼Œä¸æ˜¯ã€ŒæŒ‡ä»¤ã€
- å»ºè­°åªæ”¾é—œéµå°ˆæœ‰åè©
- Prompt èªè¨€æ‡‰èˆ‡éŸ³è¨Šèªè¨€åŒ¹é…ï¼ˆéƒ½ç”¨ä¸­æ–‡ï¼‰

**Windows ç‰ˆæœ¬æ‡‰å…è¨±ä½¿ç”¨è€…è‡ªè¨‚æ­¤ Promptï¼ˆä¾‹å¦‚è¨­å®šæª”æˆ–ç’°å¢ƒè®Šæ•¸ï¼‰ã€‚**

### 2.6 å¾Œè™•ç†ï¼ˆRegex ä¿®æ­£ + Trimï¼‰

**Regex ä¿®æ­£è¦å‰‡ï¼š**

| æœå°‹æ¨¡å¼ | æ›¿æ›ç‚º | æ——æ¨™ | èªªæ˜ |
|---------|--------|------|------|
| `N8n\|N 8 n` | `n8n` | å¿½ç•¥å¤§å°å¯« (i) | Whisper å¸¸æŠŠ n8n è¾¨è­˜ç‚º N8n æˆ– N 8 n |

**Trimï¼š**
- ç§»é™¤é–‹é ­å’Œçµå°¾çš„ç©ºç™½å­—å…ƒï¼ˆç©ºæ ¼ã€æ›è¡Œç­‰ï¼‰

**æ³¨æ„ï¼š** ä»¥ä¸Šæ˜¯ç›®å‰å”¯ä¸€çš„ Regex è¦å‰‡ã€‚Windows ç‰ˆæœ¬æ‡‰è¨­è¨ˆç‚ºå¯æ“´å……çš„è¦å‰‡åˆ—è¡¨ï¼Œæ–¹ä¾¿æ—¥å¾ŒåŠ å…¥æ›´å¤šä¿®æ­£ã€‚

### 2.7 è²¼ä¸Šæ–‡å­—

- macOS ç‰ˆæœ¬ä½¿ç”¨ Keyboard Maestro çš„ã€ŒInsertText ByPastingã€åŠŸèƒ½
- ç­‰æ•ˆæ–¼ï¼šå°‡æ–‡å­—å¯«å…¥å‰ªè²¼ç°¿ â†’ æ¨¡æ“¬ `Cmd+V`ï¼ˆmacOSï¼‰/ `Ctrl+V`ï¼ˆWindowsï¼‰è²¼ä¸Š
- è²¼ä¸Šåˆ°**ç•¶å‰æœ‰ç„¦é»çš„æ‡‰ç”¨ç¨‹å¼**çš„æ¸¸æ¨™ä½ç½®

**Windows ç­‰æ•ˆæ–¹å¼ï¼š**
- AutoHotkey: `A_Clipboard := text` ç„¶å¾Œ `Send "^v"`
- Python: `pyperclip.copy(text)` ç„¶å¾Œ `keyboard.send('ctrl+v')`

---

## ä¸‰ã€Windows 10 å¯¦ä½œæ–¹æ¡ˆ

### æ–¹æ¡ˆä¸€ï¼šAutoHotkey v2 + SoX

> **é©åˆï¼š** åå¥½è¼•é‡è…³æœ¬ã€é¡˜æ„å®‰è£ AutoHotkey çš„ä½¿ç”¨è€…

#### 3.1.1 éœ€è¦å®‰è£çš„è»Ÿé«”

| è»Ÿé«” | ç‰ˆæœ¬ | ç”¨é€” | ä¸‹è¼‰ä¾†æº |
|------|------|------|---------|
| AutoHotkey v2 | 2.0+ | ç†±éµåµæ¸¬ã€æµç¨‹æ§åˆ¶ | https://www.autohotkey.com/ |
| SoX | 14.4.2 | éŒ„éŸ³ | https://sourceforge.net/projects/sox/ |
| curl | å…§å»º | API å‘¼å« | Windows 10 1803+ å…§å»º `curl.exe` |
| jqï¼ˆå¯é¸ï¼‰ | æœ€æ–° | JSON è§£æ | https://jqlang.github.io/jq/ æˆ–ä¸è£ï¼Œç”¨ AHK å…§å»º JSON è§£æ |

#### 3.1.2 SoX Windows å®‰è£æ³¨æ„äº‹é …

1. ä¸‹è¼‰ SoX for Windows (sox-14.4.2-win32.zip æˆ– .exe å®‰è£åŒ…)
2. å®‰è£å¾Œç¢ºèª `sox.exe` è·¯å¾‘åŠ å…¥ç³»çµ± `PATH` ç’°å¢ƒè®Šæ•¸
3. **Windows ä¸Šæ²’æœ‰ `rec.exe`**ï¼ŒéŒ„éŸ³æŒ‡ä»¤ç”¨ `sox.exe -d` æ›¿ä»£ï¼š
   ```batch
   sox.exe -d -r 16000 -c 1 -b 16 my_voice.wav
   ```
4. å¯èƒ½éœ€è¨­å®šç’°å¢ƒè®Šæ•¸ `AUDIODRIVER=waveaudio`ï¼ˆé€šå¸¸ Windows è‡ªå‹•åµæ¸¬ï¼‰
5. å¯åœ¨å‘½ä»¤åˆ—åŸ·è¡Œ `sox.exe -d -r 16000 -c 1 -b 16 test.wav` æ‰‹å‹•æ¸¬è©¦éŒ„éŸ³æ˜¯å¦æ­£å¸¸

#### 3.1.3 æª”æ¡ˆçµæ§‹

```
whisper-voice-typing/
â”œâ”€â”€ whisper.ahk              â† ä¸»ç¨‹å¼ï¼ˆAutoHotkey v2 è…³æœ¬ï¼‰
â”œâ”€â”€ config.ini               â† è¨­å®šæª”ï¼ˆAPI Keyã€Promptã€éŒ„éŸ³åƒæ•¸ç­‰ï¼‰
â”œâ”€â”€ README.md                â† ä½¿ç”¨èªªæ˜
â””â”€â”€ assets/
    â””â”€â”€ icon.ico             â† ï¼ˆå¯é¸ï¼‰ç³»çµ±åŒ£åœ–ç¤º
```

#### 3.1.4 `config.ini` è¨­è¨ˆ

```ini
[API]
OpenAI_API_Key=YOUR_OPENAI_API_KEY_HERE
Model=whisper-1
Language=zh
Temperature=0.0
ResponseFormat=json

[Recording]
SampleRate=16000
Channels=1
BitDepth=16
TempFile=%TEMP%\my_voice.wav
SoxPath=sox.exe

[Prompt]
; å¯è‡ªè¨‚çš„è©å½™å¼•å°ï¼Œæœ€å¤š 224 tokens
PromptText=è«‹ä½¿ç”¨ç¹é«”ä¸­æ–‡ã€‚åŒ…å«ï¼šè•­æ·³äº‘, å‘¨èŠ·è“, åˆä½œå» å•†åŠ æ¨¡, å°ˆæ¡ˆ Tahoe, n8n, Zeaburã€‚

[Hotkey]
RecordKey=F1

[PostProcess]
; æ ¼å¼ï¼šæœå°‹æ¨¡å¼|æ›¿æ›æ–‡å­—ï¼ˆæ¯è¡Œä¸€æ¢ï¼‰
Regex1=N8n|N 8 n=>n8n
```

#### 3.1.5 `whisper.ahk` ä¸»ç¨‹å¼é‚è¼¯

```
                â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                â”‚  ç¨‹å¼å•Ÿå‹•     â”‚
                â”‚  è®€å– config â”‚
                â”‚  é¡¯ç¤º Tray   â”‚
                â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜
                       â”‚
                â”Œâ”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”
                â”‚ ç­‰å¾… F1 æŒ‰ä¸‹  â”‚â—„â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜                    â”‚
                       â”‚                            â”‚
                â”Œâ”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”                    â”‚
                â”‚ åˆªé™¤èˆŠéŒ„éŸ³æª”  â”‚                    â”‚
                â”‚ å•Ÿå‹• sox.exe  â”‚                    â”‚
                â”‚ å–å¾— PID      â”‚                    â”‚
                â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜                    â”‚
                       â”‚                            â”‚
                â”Œâ”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”                    â”‚
                â”‚ ç­‰å¾… WAV >   â”‚                    â”‚
                â”‚ 4096 bytes   â”‚                    â”‚
                â”‚ (æ¯ 50ms æª¢æŸ¥)â”‚                    â”‚
                â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜                    â”‚
                       â”‚                            â”‚
                â”Œâ”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”                    â”‚
                â”‚ SoundBeep    â”‚                    â”‚
                â”‚ 1000Hz 200ms â”‚                    â”‚
                â”‚ (é€šçŸ¥é–‹å§‹èªªè©±) â”‚                    â”‚
                â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜                    â”‚
                       â”‚                            â”‚
                â”Œâ”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”                    â”‚
                â”‚ ç­‰å¾… F1 æ”¾é–‹  â”‚                    â”‚
                â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜                    â”‚
                       â”‚                            â”‚
                â”Œâ”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”                    â”‚
                â”‚ taskkill SoX â”‚                    â”‚
                â”‚ Sleep 200ms  â”‚                    â”‚
                â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜                    â”‚
                       â”‚                            â”‚
                â”Œâ”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”                    â”‚
                â”‚ curl å‘¼å«    â”‚                    â”‚
                â”‚ Whisper API  â”‚                    â”‚
                â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜                    â”‚
                       â”‚                            â”‚
                â”Œâ”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”                    â”‚
                â”‚ è§£æ JSON    â”‚                    â”‚
                â”‚ Regex ä¿®æ­£   â”‚                    â”‚
                â”‚ Trim ç©ºç™½    â”‚                    â”‚
                â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜                    â”‚
                       â”‚                            â”‚
                â”Œâ”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”                    â”‚
                â”‚ å¯«å…¥å‰ªè²¼ç°¿   â”‚                    â”‚
                â”‚ æ¨¡æ“¬ Ctrl+V  â”‚                    â”‚
                â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜                    â”‚
                       â”‚                            â”‚
                       â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

#### 3.1.6 é—œéµ AHK v2 èªæ³•åƒè€ƒ

**ç†±éµåµæ¸¬ï¼ˆæŒ‰ä½/æ”¾é–‹ï¼‰ï¼š**
```autohotkey
#Requires AutoHotkey v2.0

; F1 æŒ‰ä¸‹ â†’ é–‹å§‹éŒ„éŸ³
F1:: {
    global soxPid
    tempFile := EnvGet("TEMP") "\my_voice.wav"
    try FileDelete(tempFile)

    ; å•Ÿå‹• SoX éŒ„éŸ³ï¼ˆéš±è—è¦–çª—ï¼‰
    Run 'sox.exe -d -r 16000 -c 1 -b 16 "' tempFile '"', , "Hide", &soxPid

    ; ç­‰å¾…æª”æ¡ˆå°±ç·’å¾Œ beep
    loop 60 {
        Sleep 50
        if FileExist(tempFile) && FileGetSize(tempFile) > 4096 {
            SoundBeep 1000, 200
            break
        }
    }
}

; F1 æ”¾é–‹ â†’ åœæ­¢éŒ„éŸ³ã€å‘¼å« APIã€è²¼ä¸Š
F1 Up:: {
    global soxPid
    ; åœæ­¢éŒ„éŸ³
    ProcessClose(soxPid)
    Sleep 200

    ; å¾ŒçºŒå‘¼å« API...
}
```

**å‘¼å« curl å–å¾—çµæœï¼š**
```autohotkey
; åŒæ­¥åŸ·è¡Œ curl ä¸¦å–å¾—è¼¸å‡º
tempFile := EnvGet("TEMP") "\my_voice.wav"
responseFile := EnvGet("TEMP") "\whisper_response.json"

cmd := 'curl.exe -s -f'
    . ' -H "Authorization: Bearer ' . apiKey . '"'
    . ' -H "Content-Type: multipart/form-data"'
    . ' -F file="@' . tempFile . '"'
    . ' -F model="whisper-1"'
    . ' -F language="zh"'
    . ' -F temperature="0.0"'
    . ' -F response_format="json"'
    . ' -F prompt="' . promptText . '"'
    . ' "https://api.openai.com/v1/audio/transcriptions"'
    . ' -o "' . responseFile . '"'

RunWait cmd, , "Hide"

; è®€å– JSON å›æ‡‰
jsonStr := FileRead(responseFile)
```

**JSON è§£æï¼ˆAHK v2 å…§å»ºï¼‰ï¼š**
- AHK v2 æ²’æœ‰å…§å»º JSON è§£æå™¨ï¼Œéœ€ä½¿ç”¨ç¬¬ä¸‰æ–¹å‡½å¼åº«å¦‚ `Jxon` æˆ– `JSON.ahk`
- æˆ–ç”¨ç°¡å–®çš„ RegEx æå– `.text` æ¬„ä½ï¼š
```autohotkey
RegExMatch(jsonStr, '"text"\s*:\s*"(.*?)"', &match)
text := match[1]
```

**Regex ä¿®æ­£ï¼š**
```autohotkey
text := RegExReplace(text, "i)N8n|N 8 n", "n8n")
text := Trim(text)
```

**è²¼ä¸Šï¼š**
```autohotkey
A_Clipboard := text
Sleep 100
Send "^v"
```

#### 3.1.7 AHK æ–¹æ¡ˆæ³¨æ„äº‹é …

1. **ç®¡ç†å“¡æ¬Šé™ï¼š** å¦‚æœç›®æ¨™è¦–çª—æ˜¯ä»¥ç®¡ç†å“¡èº«ä»½åŸ·è¡Œçš„ï¼ˆå¦‚æŸäº› IDEï¼‰ï¼ŒAHK è…³æœ¬ä¹Ÿéœ€è¦ä»¥ç®¡ç†å“¡èº«ä»½åŸ·è¡Œæ‰èƒ½å¾€è©²è¦–çª—è²¼ä¸Šæ–‡å­—
2. **SoX åœæ­¢å•é¡Œï¼š** `ProcessClose()` åœ¨ Windows ä¸Šæ˜¯å¼·åˆ¶çµ‚æ­¢ï¼ˆé¡ä¼¼ SIGKILLï¼‰ï¼ŒWAV æª”æ¡ˆå¯èƒ½ä¸å®Œæ•´ã€‚**è§£æ±ºæ–¹æ¡ˆï¼š**
   - æ–¹æ³• Aï¼šåœ¨ API å‘¼å«å‰ç”¨ ffmpeg ä¿®å¾© WAV header
   - æ–¹æ³• Bï¼šæ”¹ç”¨ PowerShell çš„ `Stop-Process` æ­é… `-PassThru`
   - æ–¹æ³• Cï¼šå¦‚æœ `ProcessClose` å°è‡´æå£é »ç¹ï¼Œæ”¹ç”¨æ–¹æ¡ˆäºŒï¼ˆPythonï¼‰
3. **é˜²æ­¢é‡è¤‡è§¸ç™¼ï¼š** æŒ‰ä½ F1 æ™‚ Windows æœƒé‡è¤‡é€å‡º KeyDown äº‹ä»¶ï¼Œéœ€åŠ å…¥ `#MaxThreadsPerHotkey 1` å’Œç‹€æ…‹ç®¡ç†ï¼Œé¿å…å¤šæ¬¡å•Ÿå‹•éŒ„éŸ³
4. **Tray åœ–ç¤ºï¼š** å¯ç”¨ `TraySetIcon` å’Œ `A_TrayMenu` é¡¯ç¤ºç‹€æ…‹ï¼ˆéŒ„éŸ³ä¸­/å¾…æ©Ÿï¼‰
5. **é–‹æ©Ÿè‡ªå•Ÿï¼š** å°‡ `.ahk` æª”æ¡ˆæ·å¾‘æ”¾å…¥ `shell:startup` è³‡æ–™å¤¾

#### 3.1.8 éŒ¯èª¤è™•ç†å»ºè­°

- API Key æœªè¨­å®š â†’ å•Ÿå‹•æ™‚å½ˆå‡º MsgBox æç¤º
- éŒ„éŸ³æª”ä¸å­˜åœ¨æˆ–éå°ï¼ˆ< 5KBï¼‰â†’ å¯èƒ½æ˜¯æŒ‰å¤ªå¿«ï¼ŒToolTip æç¤ºã€ŒéŒ„éŸ³æ™‚é–“éçŸ­ã€
- API å›å‚³éŒ¯èª¤ â†’ æª¢æŸ¥ HTTP status codeï¼ŒToolTip é¡¯ç¤ºéŒ¯èª¤è¨Šæ¯
- SoX æœªå®‰è£ â†’ å•Ÿå‹•æ™‚æª¢æŸ¥ `sox.exe` æ˜¯å¦å¯åŸ·è¡Œï¼Œæç¤ºå®‰è£
- ç¶²è·¯ç„¡é€£ç·š â†’ curl é€¾æ™‚è™•ç†ï¼ˆåŠ  `--connect-timeout 10 --max-time 30`ï¼‰

---

### æ–¹æ¡ˆäºŒï¼šPython ç¨ç«‹ç¨‹å¼ï¼ˆå¯æ‰“åŒ…æˆ .exeï¼‰

> **é©åˆï¼š** å¸Œæœ›çµ¦åŒäº‹ã€Œé›™æ“Šå³ç”¨ã€é«”é©—ã€ä¸æƒ³å®‰è£é¡å¤–è»Ÿé«”çš„æƒ…å¢ƒ

#### 3.2.1 éœ€è¦å®‰è£çš„è»Ÿé«”ï¼ˆé–‹ç™¼ç’°å¢ƒï¼‰

| è»Ÿé«” | ç‰ˆæœ¬ | ç”¨é€” |
|------|------|------|
| Python | 3.8+ (å»ºè­° 3.10+) | ä¸»ç¨‹å¼èªè¨€ |
| pip å¥—ä»¶ | è¦‹ä¸‹æ–¹ | å„ç¨®åŠŸèƒ½ |
| PyInstaller | æœ€æ–° | æ‰“åŒ…æˆ .exe |

**pip å¥—ä»¶æ¸…å–®ï¼š**

```
sounddevice>=0.5.0     # éŒ„éŸ³ï¼ˆè‡ªå¸¶ PortAudio DLLï¼ŒWindows å…é¡å¤–å®‰è£ï¼‰
numpy                  # éŸ³è¨Šæ•¸æ“šè™•ç†ï¼ˆsounddevice ä¾è³´ï¼‰
soundfile              # å°‡éŸ³è¨Šæ•¸æ“šå¯«å…¥ WAV æª”æ¡ˆ
requests               # HTTP å‘¼å« OpenAI API
keyboard               # å…¨åŸŸç†±éµåµæ¸¬ï¼ˆF1 æŒ‰ä¸‹/æ”¾é–‹ï¼‰
pyperclip              # å‰ªè²¼ç°¿æ“ä½œ
pystray                # ç³»çµ±åŒ£åœ–ç¤ºï¼ˆå¯é¸ï¼‰
Pillow                 # pystray çš„ä¾è³´ï¼ˆå¯é¸ï¼‰
```

**çµ‚ç«¯ä½¿ç”¨è€…ï¼ˆåŒäº‹ï¼‰ä¸éœ€å®‰è£ä»»ä½•æ±è¥¿** â€” æ‰“åŒ…å¾Œçš„ .exe åŒ…å«æ‰€æœ‰ä¾è³´ã€‚

#### 3.2.2 æª”æ¡ˆçµæ§‹

```
whisper-voice-typing-py/
â”œâ”€â”€ main.py                  â† ä¸»ç¨‹å¼å…¥å£
â”œâ”€â”€ recorder.py              â† éŒ„éŸ³æ¨¡çµ„
â”œâ”€â”€ transcriber.py           â† Whisper API å‘¼å«æ¨¡çµ„
â”œâ”€â”€ postprocess.py           â† å¾Œè™•ç†ï¼ˆRegexã€Trimï¼‰
â”œâ”€â”€ config.py                â† è¨­å®šè®€å–
â”œâ”€â”€ config.json              â† ä½¿ç”¨è€…è¨­å®šæª”
â”œâ”€â”€ requirements.txt         â† pip ä¾è³´
â”œâ”€â”€ build.bat                â† PyInstaller æ‰“åŒ…è…³æœ¬
â”œâ”€â”€ README.md                â† ä½¿ç”¨èªªæ˜
â””â”€â”€ assets/
    â””â”€â”€ icon.ico             â† ç³»çµ±åŒ£åœ–ç¤º
```

#### 3.2.3 `config.json` è¨­è¨ˆ

```json
{
  "api": {
    "openai_api_key": "YOUR_OPENAI_API_KEY_HERE",
    "model": "whisper-1",
    "language": "zh",
    "temperature": 0.0,
    "response_format": "json"
  },
  "recording": {
    "sample_rate": 16000,
    "channels": 1,
    "bit_depth": 16
  },
  "prompt": {
    "text": "è«‹ä½¿ç”¨ç¹é«”ä¸­æ–‡ã€‚åŒ…å«ï¼šè•­æ·³äº‘, å‘¨èŠ·è“, åˆä½œå» å•†åŠ æ¨¡, å°ˆæ¡ˆ Tahoe, n8n, Zeaburã€‚"
  },
  "hotkey": {
    "record_key": "F1"
  },
  "post_process": {
    "regex_rules": [
      {
        "pattern": "N8n|N 8 n",
        "replacement": "n8n",
        "flags": "IGNORECASE"
      }
    ]
  }
}
```

#### 3.2.4 å„æ¨¡çµ„å¯¦ä½œé‚è¼¯

##### `recorder.py` â€” éŒ„éŸ³æ¨¡çµ„

```
é¡åˆ¥ï¼šAudioRecorder

å±¬æ€§ï¼š
  - sample_rate: int = 16000
  - channels: int = 1
  - dtype: str = 'int16'  (ç­‰åŒ 16-bit PCM)
  - is_recording: bool
  - audio_frames: list (å­˜æ”¾éŒ„éŸ³æ•¸æ“šçš„ buffer)

æ–¹æ³•ï¼š
  - start_recording():
      1. æ¸…ç©º audio_frames
      2. å»ºç«‹ sounddevice.InputStream(callback=_audio_callback)
      3. stream.start()
      4. ç­‰å¾… buffer ç´¯ç©åˆ° > 4096 samples (ç´„ 0.25 ç§’)
      5. æ’­æ”¾ beep æç¤ºéŸ³ï¼šwinsound.Beep(1000, 200)
      6. è¨­å®š is_recording = True

  - _audio_callback(indata, frames, time, status):
      å°‡ indata.copy() åŠ å…¥ audio_frames åˆ—è¡¨

  - stop_recording() -> str:
      1. stream.stop()
      2. stream.close()
      3. åˆä½µæ‰€æœ‰ audio_frames ç‚º numpy array
      4. ç”¨ soundfile.write() å­˜æˆ WAV æª”æ¡ˆ
      5. å›å‚³ WAV æª”æ¡ˆè·¯å¾‘
      6. è¨­å®š is_recording = False
```

**sounddevice çš„å„ªå‹¢ï¼š**
- PortAudio åœ¨èƒŒæ™¯ç·šç¨‹ä¸­éŒ„éŸ³ï¼Œä¸é˜»å¡ä¸»ç·šç¨‹
- ä¸éœ€å¤–éƒ¨ç¨‹å¼ï¼ˆSoXï¼‰ï¼Œä¸æœƒæœ‰ WAV header æå£å•é¡Œ
- Windows å®‰è£è‡ªå¸¶ PortAudio DLLï¼Œé›¶é¡å¤–ä¾è³´

**Beep é€šçŸ¥å¯¦ä½œï¼š**
```python
import winsound

# æ–¹å¼ä¸€ï¼šè‡ªè¨‚é »ç‡å’Œæ™‚é•·ï¼ˆåŒæ­¥ï¼Œæœƒé˜»å¡ï¼‰
winsound.Beep(1000, 200)  # 1000Hz, 200ms

# æ–¹å¼äºŒï¼šç³»çµ±é è¨­æç¤ºéŸ³ï¼ˆéåŒæ­¥ï¼‰
winsound.MessageBeep(winsound.MB_OK)
```

å»ºè­°ç”¨æ–¹å¼ä¸€ï¼ˆ`winsound.Beep`ï¼‰ï¼Œèˆ‡ macOS ç‰ˆçš„ `beep 1` é«”é©—ä¸€è‡´ã€‚æ³¨æ„ `winsound.Beep` æ˜¯åŒæ­¥çš„ï¼Œä½† 200ms å¾ˆçŸ­ï¼Œä¸å½±éŸ¿é«”é©—ã€‚

##### `transcriber.py` â€” API å‘¼å«æ¨¡çµ„

```
å‡½å¼ï¼štranscribe(wav_path, api_key, model, language, temperature, response_format, prompt) -> str

å¯¦ä½œï¼š
  1. é–‹å•Ÿ WAV æª”æ¡ˆ
  2. å»ºæ§‹ multipart/form-data è«‹æ±‚
  3. POST åˆ° https://api.openai.com/v1/audio/transcriptions
  4. è§£æ JSON å›æ‡‰ï¼Œå›å‚³ .text æ¬„ä½

requests å‘¼å«ç¯„ä¾‹ï¼š
  url = "https://api.openai.com/v1/audio/transcriptions"
  headers = {"Authorization": f"Bearer {api_key}"}
  files = {"file": ("my_voice.wav", open(wav_path, "rb"), "audio/wav")}
  data = {
      "model": model,
      "language": language,
      "temperature": str(temperature),
      "response_format": response_format,
      "prompt": prompt
  }
  response = requests.post(url, headers=headers, files=files, data=data, timeout=30)
  response.raise_for_status()
  return response.json()["text"]
```

##### `postprocess.py` â€” å¾Œè™•ç†æ¨¡çµ„

```
å‡½å¼ï¼šapply_corrections(text, regex_rules) -> str

å¯¦ä½œï¼š
  1. éæ­· regex_rules åˆ—è¡¨
  2. å°æ¯æ¢è¦å‰‡åŸ·è¡Œ re.sub(pattern, replacement, text, flags)
  3. æœ€å¾Œ text.strip()
  4. å›å‚³ä¿®æ­£å¾Œçš„æ–‡å­—
```

##### `main.py` â€” ä¸»ç¨‹å¼æµç¨‹

```
                â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                â”‚  ç¨‹å¼å•Ÿå‹•     â”‚
                â”‚  è®€å– config â”‚
                â”‚  å»ºç«‹ Tray   â”‚
                â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜
                       â”‚
                â”Œâ”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”
                â”‚ è¨»å†Šå…¨åŸŸç†±éµ  â”‚
                â”‚ keyboard.on  â”‚
                â”‚ _press/      â”‚
                â”‚ _release     â”‚
                â”‚ (F1)         â”‚
                â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜
                       â”‚
                â”Œâ”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”
                â”‚  ä¸»è¿´åœˆç­‰å¾…   â”‚â—„â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                â”‚  (äº‹ä»¶é©…å‹•)   â”‚                    â”‚
                â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜                    â”‚
                       â”‚ F1 æŒ‰ä¸‹                    â”‚
                â”Œâ”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”                    â”‚
                â”‚ recorder     â”‚                    â”‚
                â”‚ .start_      â”‚                    â”‚
                â”‚ recording()  â”‚                    â”‚
                â”‚ + beep       â”‚                    â”‚
                â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜                    â”‚
                       â”‚ F1 æ”¾é–‹                    â”‚
                â”Œâ”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”                    â”‚
                â”‚ recorder     â”‚                    â”‚
                â”‚ .stop_       â”‚                    â”‚
                â”‚ recording()  â”‚                    â”‚
                â”‚ â†’ wav_path   â”‚                    â”‚
                â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜                    â”‚
                       â”‚                            â”‚
                â”Œâ”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”                    â”‚
                â”‚ transcriber  â”‚                    â”‚
                â”‚ .transcribe()â”‚                    â”‚
                â”‚ â†’ raw_text   â”‚                    â”‚
                â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜                    â”‚
                       â”‚                            â”‚
                â”Œâ”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”                    â”‚
                â”‚ postprocess  â”‚                    â”‚
                â”‚ .apply_      â”‚                    â”‚
                â”‚ corrections()â”‚                    â”‚
                â”‚ â†’ final_text â”‚                    â”‚
                â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜                    â”‚
                       â”‚                            â”‚
                â”Œâ”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”                    â”‚
                â”‚ pyperclip    â”‚                    â”‚
                â”‚ .copy(text)  â”‚                    â”‚
                â”‚ keyboard     â”‚                    â”‚
                â”‚ .send(ctrl+v)â”‚                    â”‚
                â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜                    â”‚
                       â”‚                            â”‚
                       â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

**keyboard å¥—ä»¶çš„ç†±éµåµæ¸¬ï¼š**
```python
import keyboard

# åµæ¸¬ F1 æŒ‰ä¸‹ï¼ˆkey downï¼‰
keyboard.on_press_key("F1", on_f1_press)

# åµæ¸¬ F1 æ”¾é–‹ï¼ˆkey upï¼‰
keyboard.on_release_key("F1", on_f1_release)

# é˜»æ­¢äº‹ä»¶å¾ªç’°çµæŸ
keyboard.wait()  # æ°¸ä¹…ç­‰å¾…ï¼Œç›´åˆ°ç¨‹å¼è¢«çµ‚æ­¢
```

**æ³¨æ„ï¼š** `keyboard` å¥—ä»¶åœ¨ Windows ä¸Šéœ€è¦ç®¡ç†å“¡æ¬Šé™æ‰èƒ½åµæ¸¬å…¨åŸŸç†±éµã€‚å¦‚æœä¸æƒ³è¦æ±‚ç®¡ç†å“¡æ¬Šé™ï¼Œå¯æ”¹ç”¨ `pynput`ï¼š
```python
from pynput import keyboard

def on_press(key):
    if key == keyboard.Key.f1:
        start_recording()

def on_release(key):
    if key == keyboard.Key.f1:
        stop_and_transcribe()

listener = keyboard.Listener(on_press=on_press, on_release=on_release)
listener.start()
listener.join()
```

`pynput` ä¸éœ€ç®¡ç†å“¡æ¬Šé™ï¼ˆæ¨è–¦ï¼‰ã€‚

#### 3.2.5 æ‰“åŒ…æˆ .exe

**build.batï¼š**
```batch
pip install pyinstaller
pyinstaller --onefile --windowed --icon=assets/icon.ico --name="WhisperVoiceTyping" main.py
```

| PyInstaller åƒæ•¸ | èªªæ˜ |
|-----------------|------|
| `--onefile` | æ‰“åŒ…æˆå–®ä¸€ .exe æª”æ¡ˆ |
| `--windowed` | ä¸é¡¯ç¤ºå‘½ä»¤åˆ—è¦–çª—ï¼ˆGUI æ¨¡å¼ï¼‰ |
| `--icon` | è‡ªè¨‚åœ–ç¤º |
| `--name` | è¼¸å‡ºçš„ exe æª”å |

**æ‰“åŒ…å¾Œæª”æ¡ˆçµæ§‹ï¼š**
```
dist/
â””â”€â”€ WhisperVoiceTyping.exe    â† çµ¦åŒäº‹çš„æª”æ¡ˆï¼ˆç´„ 30-50MBï¼‰
```

**åŒäº‹ä½¿ç”¨æ–¹å¼ï¼š**
1. ä¸‹è¼‰ `WhisperVoiceTyping.exe` å’Œ `config.json`
2. ç·¨è¼¯ `config.json` å¡«å…¥ API Key
3. é›™æ“Š `WhisperVoiceTyping.exe` å•Ÿå‹•
4. æŒ‰ä½ F1 èªªè©± â†’ æ”¾é–‹ â†’ è‡ªå‹•è²¼ä¸Šæ–‡å­—

#### 3.2.6 ç³»çµ±åŒ£åœ–ç¤ºï¼ˆå¯é¸ä½†æ¨è–¦ï¼‰

ä½¿ç”¨ `pystray` å¥—ä»¶åœ¨ Windows ç³»çµ±åŒ£é¡¯ç¤ºåœ–ç¤ºï¼š

```
ç³»çµ±åŒ£åœ–ç¤ºåŠŸèƒ½ï¼š
  - é¡¯ç¤ºç¨‹å¼é‹ä½œç‹€æ…‹ï¼ˆå¾…æ©Ÿä¸­ / éŒ„éŸ³ä¸­ / è™•ç†ä¸­ï¼‰
  - å³éµé¸å–®ï¼š
    - âœ… å•Ÿç”¨ä¸­ï¼ˆå¯åˆ‡æ›é–‹é—œï¼‰
    - ğŸ“ é–‹å•Ÿè¨­å®šæª”
    - âŒ çµæŸç¨‹å¼
  - åœ–ç¤ºé¡è‰²/ç‹€æ…‹è®ŠåŒ–ï¼š
    - ç°è‰²ï¼šå¾…æ©Ÿä¸­
    - ç´…è‰²ï¼šéŒ„éŸ³ä¸­
    - è—è‰²ï¼šAPI è™•ç†ä¸­
```

#### 3.2.7 Python æ–¹æ¡ˆæ³¨æ„äº‹é …

1. **ç®¡ç†å“¡æ¬Šé™ï¼š**
   - `keyboard` å¥—ä»¶éœ€è¦ç®¡ç†å“¡æ¬Šé™ï¼Œ**å»ºè­°æ”¹ç”¨ `pynput`**ï¼ˆä¸éœ€ç®¡ç†å“¡ï¼‰
   - å¦‚æœç›®æ¨™æ‡‰ç”¨ç¨‹å¼æ˜¯ç®¡ç†å“¡èº«ä»½åŸ·è¡Œçš„ï¼Œå‰‡ç•¶å‰ç¨‹å¼ä¹Ÿéœ€ç®¡ç†å“¡
2. **é˜²æ¯’è»Ÿé«”ï¼š** PyInstaller æ‰“åŒ…çš„ .exe å¯èƒ½è¢« Windows Defender èª¤åˆ¤ç‚ºç—…æ¯’ï¼Œéœ€è¦ï¼š
   - é¦–æ¬¡åŸ·è¡Œæ™‚ã€Œæ›´å¤šè³‡è¨Š â†’ ä»è¦åŸ·è¡Œã€
   - æˆ–å°‡ exe åŠ å…¥ Windows Defender æ’é™¤æ¸…å–®
   - æˆ–ä½¿ç”¨ code signing certificate ç°½ç½²
3. **config.json ä½ç½®ï¼š** æ‰“åŒ…æˆ .exe å¾Œï¼Œconfig.json æ‡‰æ”¾åœ¨ exe æ—é‚Šã€‚ç¨‹å¼å•Ÿå‹•æ™‚æŒ‰ä»¥ä¸‹é †åºå°‹æ‰¾ï¼š
   - èˆ‡ exe åŒç›®éŒ„çš„ `config.json`
   - ä½¿ç”¨è€…ç›®éŒ„ `%USERPROFILE%\.whisper-voice-typing\config.json`
4. **API Key å®‰å…¨ï¼š** config.json ä»¥æ˜æ–‡å­˜æ”¾ API Keyï¼ˆèˆ‡ macOS KM è®Šæ•¸ç›¸åŒå®‰å…¨ç­‰ç´šï¼‰ã€‚é€²éšåšæ³•å¯ä½¿ç”¨ Windows Credential Managerï¼Œä½†ä¸€èˆ¬ä½¿ç”¨ä¸éœ€è¦ã€‚
5. **hotkey è¡çªï¼š** F1 åœ¨å¾ˆå¤šæ‡‰ç”¨ç¨‹å¼æ˜¯ã€Œèªªæ˜ã€éµã€‚å¯åœ¨ config.json ä¸­è®“ä½¿ç”¨è€…è‡ªè¨‚ã€‚å»ºè­°æä¾›å‚™é¸ï¼š`F1`, `F2`, `F8`, `Ctrl+Shift+R` ç­‰ã€‚
6. **sounddevice è£ç½®é¸æ“‡ï¼š** å¦‚æœåŒäº‹æœ‰å¤šå€‹éº¥å…‹é¢¨ï¼Œå¯åœ¨ config.json åŠ å…¥ `device_index` åƒæ•¸ã€‚é è¨­ä½¿ç”¨ç³»çµ±é è¨­éŒ„éŸ³è£ç½®ã€‚åˆ—å‡ºè£ç½®ï¼š`python -m sounddevice`
7. **exe æª”æ¡ˆå¤§å°ï¼š** ç´„ 30-50MBï¼ˆåŒ…å« Python runtime + PortAudio + numpyï¼‰ï¼Œå±¬æ­£å¸¸ç¯„åœ

#### 3.2.8 éŒ¯èª¤è™•ç†èˆ‡ä½¿ç”¨è€…é«”é©—

| ç‹€æ³ | è™•ç†æ–¹å¼ |
|------|---------|
| API Key æœªè¨­å®š | å•Ÿå‹•æ™‚å½ˆå‡ºå°è©±æ¡†æç¤ºè¨­å®š |
| éŒ„éŸ³æ™‚é–“ < 0.5 ç§’ | å¿½ç•¥æ­¤æ¬¡éŒ„éŸ³ï¼ŒToolTip æç¤ºã€ŒéŒ„éŸ³æ™‚é–“éçŸ­ã€|
| API å›å‚³ 401 | ToolTip æç¤ºã€ŒAPI Key ç„¡æ•ˆã€ |
| API å›å‚³ 429 | ToolTip æç¤ºã€ŒAPI è«‹æ±‚éæ–¼é »ç¹ã€ |
| API é€¾æ™‚ (>30s) | ToolTip æç¤ºã€Œç¶²è·¯é€¾æ™‚ã€ |
| ç„¡éº¥å…‹é¢¨æ¬Šé™ | å•Ÿå‹•æ™‚æª¢æŸ¥ä¸¦æç¤ºé–‹å•Ÿéº¥å…‹é¢¨æ¬Šé™ |
| WAV éå¤§ (>25MB) | é™åˆ¶æœ€å¤§éŒ„éŸ³æ™‚é•·ï¼ˆç´„ 25MB Ã· 32KB/s â‰ˆ 13 åˆ†é˜ï¼‰ |
| ç¨‹å¼å·²åœ¨åŸ·è¡Œä¸­ | åµæ¸¬ä¸¦æç¤ºï¼ˆé¿å…é‡è¤‡å•Ÿå‹•ï¼‰ |

---

## å››ã€å…©æ–¹æ¡ˆæ¯”è¼ƒèˆ‡é¸æ“‡å»ºè­°

| | æ–¹æ¡ˆä¸€ï¼šAutoHotkey v2 + SoX | æ–¹æ¡ˆäºŒï¼šPython .exe |
|---|---|---|
| **å®‰è£é–€æª»** | éœ€è£ AHK + SoX | é›™æ“Š exe å³ç”¨ |
| **è…³æœ¬å¤§å°** | ~10KB (.ahk) | ~30-50MB (.exe) |
| **éŒ„éŸ³ç©©å®šåº¦** | SoX å¼·åˆ¶çµ‚æ­¢å¯èƒ½æå£ WAV | sounddevice åœ¨è¨˜æ†¶é«”æ“ä½œï¼Œä¸æœƒæå£ |
| **ç¨‹å¼èªè¨€** | AutoHotkey v2 | Python |
| **ç®¡ç†å“¡æ¬Šé™** | è¦–æƒ…æ³éœ€è¦ | ç”¨ pynput ä¸éœ€è¦ |
| **å¯ç¶­è­·æ€§** | AHK èªæ³•è¼ƒå°çœ¾ | Python é–‹ç™¼è€…å¤š |
| **é–‹ç™¼æ™‚é–“** | ~2-4 å°æ™‚ | ~4-8 å°æ™‚ |
| **ç³»çµ±åŒ£åœ–ç¤º** | å…§å»ºæ”¯æ´ | éœ€ pystray å¥—ä»¶ |

**å»ºè­°ï¼š**
- å¦‚æœä½ è‡ªå·±è¦å¹«åŒäº‹ç¶­è­· â†’ **æ–¹æ¡ˆä¸€**ï¼ˆå¿«é€Ÿã€è¼•é‡ã€å–®æª”æ¡ˆï¼‰
- å¦‚æœå¸Œæœ›åŒäº‹é›¶é–€æª»ä½¿ç”¨ â†’ **æ–¹æ¡ˆäºŒ**ï¼ˆæ‰“åŒ…æˆ exeï¼Œä¸éœ€å®‰è£ä»»ä½•æ±è¥¿ï¼‰
- **å…©è€…å¯ä»¥éƒ½åš**ï¼Œå…ˆå¿«é€Ÿç”¨æ–¹æ¡ˆä¸€é©—è­‰æµç¨‹ï¼Œå†ç”¨æ–¹æ¡ˆäºŒåšæˆ production ç‰ˆ

---

## äº”ã€å…±é€šçš„å¿…è¦è³‡è¨Š

### 5.1 OpenAI API Key å–å¾—æ–¹å¼

1. å‰å¾€ https://platform.openai.com/api-keys
2. ç™»å…¥ OpenAI å¸³è™Ÿ
3. é»é¸ã€ŒCreate new secret keyã€
4. è¤‡è£½ Keyï¼ˆ`sk-...`ï¼‰ï¼Œæ­¤ Key åªé¡¯ç¤ºä¸€æ¬¡
5. ç¢ºèªå¸³è™Ÿæœ‰è¶³å¤  creditï¼ˆWhisper API $0.006/åˆ†é˜ï¼‰

### 5.2 å®Œæ•´ API å‘¼å« curl ç¯„ä¾‹ï¼ˆå¯ç”¨æ–¼ Windows æ¸¬è©¦ï¼‰

```batch
curl.exe -s -f ^
  -H "Authorization: Bearer sk-your-key-here" ^
  -H "Content-Type: multipart/form-data" ^
  -F file="@%TEMP%\my_voice.wav" ^
  -F model="whisper-1" ^
  -F language="zh" ^
  -F temperature="0.0" ^
  -F response_format="json" ^
  -F prompt="è«‹ä½¿ç”¨ç¹é«”ä¸­æ–‡ã€‚" ^
  "https://api.openai.com/v1/audio/transcriptions"
```

> **æ³¨æ„ï¼š** Windows cmd ç”¨ `^` æ›è¡Œï¼ˆä¸åŒæ–¼ bash çš„ `\`ï¼‰ï¼ŒPowerShell ç”¨ `` ` ``ã€‚

### 5.3 Windows 10 ç³»çµ±éœ€æ±‚

- Windows 10 1803+ï¼ˆå…§å»º curl.exeï¼‰
- éº¥å…‹é¢¨ï¼ˆå…§å»ºæˆ–å¤–æ¥ï¼‰
- ç¶²è·¯é€£ç·š
- éº¥å…‹é¢¨æ¬Šé™é–‹å•Ÿï¼ˆè¨­å®š â†’ éš±ç§ â†’ éº¥å…‹é¢¨ â†’ å…è¨±æ‡‰ç”¨ç¨‹å¼å­˜å–ï¼‰

### 5.4 æ¸¬è©¦éŒ„éŸ³æŒ‡ä»¤ï¼ˆæ‰‹å‹•é©—è­‰éº¥å…‹é¢¨ï¼‰

**SoX æ–¹æ¡ˆï¼š**
```batch
sox.exe -d -r 16000 -c 1 -b 16 test.wav
:: æŒ‰ Ctrl+C åœæ­¢
:: æ’­æ”¾ï¼šsox.exe test.wav -d
```

**Python æ–¹æ¡ˆï¼ˆäº’å‹•å¼ï¼‰ï¼š**
```python
import sounddevice as sd
print(sd.query_devices())  # åˆ—å‡ºæ‰€æœ‰éŸ³è¨Šè£ç½®
```

---

## å…­ã€å¯¦ä½œå„ªå…ˆé †åºå»ºè­°

1. **å…ˆåšï¼š** æ‰‹å‹•æ¸¬è©¦ APIï¼ˆç”¨ curl åœ¨ Windows ä¸Šç¢ºèª API Key å¯ç”¨ï¼‰
2. **å†åšï¼š** æ¸¬è©¦éŒ„éŸ³ï¼ˆSoX æˆ– sounddeviceï¼Œç¢ºèªéº¥å…‹é¢¨æ­£å¸¸ï¼‰
3. **ç„¶å¾Œï¼š** å¯¦ä½œæ ¸å¿ƒæµç¨‹ï¼ˆç†±éµ â†’ éŒ„éŸ³ â†’ API â†’ è²¼ä¸Šï¼‰
4. **æ¥è‘—ï¼š** åŠ å…¥ beep æç¤ºã€Regex ä¿®æ­£ã€Trim
5. **æœ€å¾Œï¼š** åŠ å…¥ config è®€å–ã€éŒ¯èª¤è™•ç†ã€ç³»çµ±åŒ£åœ–ç¤º
6. **æ‰“åŒ…ï¼š** (æ–¹æ¡ˆäºŒ) ç”¨ PyInstaller æ‰“åŒ…æˆ exe

---

## ä¸ƒã€é™„éŒ„ï¼šå®Œæ•´çš„ macOS æµç¨‹ç´°ç¯€ï¼ˆä¾›åƒè€ƒï¼‰

### macOS Keyboard Maestro å®Œæ•´æµç¨‹ï¼ˆ20 å€‹æ­¥é©Ÿï¼‰

```
æ­¥é©Ÿ 1ï¼šF1 KeyDown è§¸ç™¼
æ­¥é©Ÿ 2ï¼šShell Script (Asynchronously) â€” é–‹å§‹éŒ„éŸ³
  - rm -f /tmp/my_voice.wav /tmp/km_rec.pid
  - /opt/homebrew/bin/rec -q -c 1 -b 16 -r 16000 /tmp/my_voice.wav &
  - echo $REC_PID > /tmp/km_rec.pid
  - è¼ªè©¢ç­‰å¾… WAV > 4096 bytes
  - /usr/bin/osascript -e 'beep 1'
æ­¥é©Ÿ 3ï¼šPauseUntil F1 KeyUp
æ­¥é©Ÿ 4ï¼šShell Script â€” åœæ­¢éŒ„éŸ³
  - killall -2 rec
  - sleep 0.2
æ­¥é©Ÿ 5ï¼šSetVariableToText "LocalPromptList"
  - "è«‹ä½¿ç”¨ç¹é«”ä¸­æ–‡ã€‚åŒ…å«ï¼šè•­æ·³äº‘, å‘¨èŠ·è“, åˆä½œå» å•†åŠ æ¨¡, å°ˆæ¡ˆ Tahoe, n8n, Zeaburã€‚"
æ­¥é©Ÿ 6ï¼šShell Script â†’ Variable "LocalApiResponse"
  - curl POST https://api.openai.com/v1/audio/transcriptions
æ­¥é©Ÿ 7ï¼šSetVariableToText "LocalWhisperText"
  - %JSONValue%LocalApiResponse.text%
æ­¥é©Ÿ 8ï¼šSearch & Replace Variable "LocalWhisperText"
  - N8n|N 8 n â†’ n8n (IgnoreCase)
æ­¥é©Ÿ 9ï¼šFilter Variable "LocalWhisperText" (TrimWhitespace)
æ­¥é©Ÿ 10ï¼šInsertText ByPasting
  - %Variable%LocalWhisperText%
```

### macOS ä½¿ç”¨çš„ç’°å¢ƒè®Šæ•¸

| è®Šæ•¸åç¨± | ç”¨é€” | Shell ä¸­çš„åç¨± |
|---------|------|---------------|
| `OpenAI_Whisper_API_Key` | OpenAI API é‡‘é‘° | `$KMVAR_OpenAI_Whisper_API_Key` |
| `LocalPromptList` | Whisper prompt | `$KMVAR_LocalPromptList` |
| `LocalApiResponse` | API åŸå§‹ JSON | `$KMVAR_LocalApiResponse` |
| `LocalWhisperText` | è™•ç†å¾Œæ–‡å­— | `$KMVAR_LocalWhisperText` |

---

## å…«ã€å¸¸è¦‹å•é¡Œ FAQ

### Q1: ç‚ºä»€éº¼ä¸€å®šè¦ç­‰ WAV > 4096 bytes æ‰ç™¼ beepï¼Ÿ
**A:** å› ç‚ºéŒ„éŸ³ç¨‹å¼å•Ÿå‹•æœ‰å»¶é²ï¼ˆé€šå¸¸ 0.1-0.5 ç§’ï¼‰ã€‚å¦‚æœç«‹å³ç™¼ beepï¼Œä½¿ç”¨è€…æœƒåœ¨éŒ„éŸ³å°šæœªå°±ç·’æ™‚å°±é–‹å§‹èªªè©±ï¼Œå°è‡´å‰å¹¾å€‹å­—è¢«æˆªæ–·ã€‚4096 bytes ä»£è¡¨è‡³å°‘æœ‰ 0.25 ç§’çš„éŸ³è¨Šæ•¸æ“šå¯«å…¥ï¼Œç¢ºèªéŒ„éŸ³ç¢ºå¯¦åœ¨é‹ä½œã€‚

### Q2: ç‚ºä»€éº¼ä¸ç”¨ mp3 è€Œç”¨ wavï¼Ÿ
**A:** 
- WAV æ˜¯ç„¡ææ ¼å¼ï¼ŒWhisper API è¾¨è­˜å“è³ªæœ€ä½³
- éŒ„éŸ³æ™‚ç”¨ mp3 éœ€è¦å³æ™‚ç·¨ç¢¼ï¼ˆè€— CPUï¼‰
- 16kHz 16-bit mono çš„ WAV æª”æ¡ˆå¾ˆå°ï¼ˆ~32KB/ç§’ï¼‰ï¼Œ1 åˆ†é˜åƒ… ~2MB
- Whisper API æœ€å¤§æ”¯æ´ 25MBï¼Œè¶³å¤ ç´„ 13 åˆ†é˜éŒ„éŸ³

### Q3: temperature=0.0 æ˜¯ä»€éº¼æ„æ€ï¼Ÿ
**A:** 
- temperature æ§åˆ¶æ¨¡å‹çš„éš¨æ©Ÿæ€§
- 0.0 = å®Œå…¨ç¢ºå®šæ€§ï¼Œæ¯æ¬¡ç”¨ç›¸åŒéŸ³è¨Šæœƒå¾—åˆ°ç›¸åŒçµæœ
- 1.0 = æœ€å¤§éš¨æ©Ÿæ€§ï¼Œæ¯æ¬¡å¯èƒ½ä¸åŒ
- å°èªéŸ³è¾¨è­˜ä¾†èªªï¼Œ0.0 æ˜¯æœ€ä½³è¨­å®šï¼ˆè¿½æ±‚æº–ç¢ºè€Œéå‰µæ„ï¼‰

### Q4: prompt å¯ä»¥æ”¾å®Œæ•´å¥å­å—ï¼Ÿ
**A:** 
- æŠ€è¡“ä¸Šå¯ä»¥ï¼Œä½†ä¸å»ºè­°
- Whisper çš„ prompt æ˜¯ç”¨ä¾†æä¾›ã€Œè©å½™æ‹¼å¯«åƒè€ƒã€ï¼Œä¸æ˜¯ã€ŒæŒ‡ä»¤ã€
- æœ€å¥½åªæ”¾å°ˆæœ‰åè©ã€äººåã€å…¬å¸åç­‰é—œéµè©
- å¤ªé•·çš„ prompt å¯èƒ½é™ä½è¾¨è­˜æº–ç¢ºåº¦

### Q5: å¦‚æœç¶²è·¯æ–·ç·šæ€éº¼è¾¦ï¼Ÿ
**A:** 
- API å‘¼å«æœƒé€¾æ™‚ï¼ˆå»ºè­°è¨­ 30 ç§’ï¼‰
- éŒ„éŸ³æª”æœƒä¿ç•™åœ¨ temp è³‡æ–™å¤¾
- å¯æ‰‹å‹•ç”¨ curl é‡è©¦
- é€²éšåšæ³•ï¼šç¨‹å¼å¯æª¢æ¸¬åˆ°éŒ¯èª¤å¾Œè‡ªå‹•é‡è©¦ 3 æ¬¡

### Q6: èƒ½é›¢ç·šä½¿ç”¨å—ï¼Ÿ
**A:** 
- OpenAI Whisper API ç„¡æ³•é›¢ç·šä½¿ç”¨
- å¦‚æœéœ€è¦é›¢ç·šï¼Œå¿…é ˆå›åˆ°æœ¬åœ° whisper.cpp æ–¹æ¡ˆï¼ˆMac mini åŸæœ¬çš„åšæ³•ï¼‰
- æˆ–ç”¨ Windows ç‰ˆçš„ Whisper.cpp (whisper.cpp æ”¯æ´ Windows)
- æœ¬åœ°æ–¹æ¡ˆéœ€è¦ï¼š
  - ä¸‹è¼‰ Large-v3 æ¨¡å‹ï¼ˆ~3GBï¼‰
  - åŸ·è¡Œ whisper-server
  - ä½”ç”¨ ~3.5GB RAM
  - ä½†å®Œå…¨å…è²»ä¸”ä¸éœ€ç¶²è·¯

### Q7: ç‚ºä»€éº¼ Python æ–¹æ¡ˆæ¨è–¦ pynput è€Œé keyboardï¼Ÿ
**A:** 
- `keyboard` éœ€è¦ç®¡ç†å“¡æ¬Šé™ï¼ˆåœ¨ Windows ä¸Šï¼‰
- `pynput` ä¸éœ€è¦ç®¡ç†å“¡æ¬Šé™å³å¯åµæ¸¬å…¨åŸŸç†±éµ
- å…©è€…åŠŸèƒ½ç›¸è¿‘ï¼Œä½† `pynput` ä½¿ç”¨é«”é©—æ›´å¥½ï¼ˆä¸éœ€æ¯æ¬¡éƒ½å³éµâ†’ä»¥ç®¡ç†å“¡èº«ä»½åŸ·è¡Œï¼‰

### Q8: F1 æŒ‰å¤ªå¿«ï¼ˆ< 0.5 ç§’ï¼‰æœƒç™¼ç”Ÿä»€éº¼ï¼Ÿ
**A:** 
- éŒ„éŸ³æª”æœƒå¾ˆå°ï¼ˆ< 1KBï¼‰ï¼ŒAPI å¯èƒ½å›å‚³éŒ¯èª¤æˆ–ç©ºå­—ä¸²
- å»ºè­°åœ¨ç¨‹å¼ä¸­åŠ å…¥æª¢æŸ¥ï¼šå¦‚æœ WAV < 5KBï¼Œç›´æ¥å¿½ç•¥ä¸¦æç¤ºã€ŒéŒ„éŸ³æ™‚é–“éçŸ­ã€
- ä¸å‘¼å« APIï¼ˆçœéŒ¢ï¼‰

---

## ä¹ã€é€²éšåŠŸèƒ½å»ºè­°ï¼ˆæœªä¾†å¯æ“´å……ï¼‰

1. **å¤šèªè¨€æ”¯æ´**
   - config ä¸­åŠ å…¥èªè¨€é¸é …ï¼šzh, en, ja, ko ç­‰
   - å¿«æ·éµåˆ‡æ›èªè¨€ï¼ˆä¾‹å¦‚ Ctrl+Shift+1 = ä¸­æ–‡ï¼ŒCtrl+Shift+2 = è‹±æ–‡ï¼‰

2. **æ­·å²è¨˜éŒ„**
   - å°‡æ¯æ¬¡è¾¨è­˜çµæœå­˜å…¥æœ¬åœ°è³‡æ–™åº«ï¼ˆSQLiteï¼‰
   - å¯æŸ¥è©¢éå»çš„è¾¨è­˜è¨˜éŒ„
   - å³éµé¸å–®ã€Œé–‹å•Ÿæ­·å²è¨˜éŒ„ã€

3. **è‡ªè¨‚å¿«æ·ä¿®æ­£è©åº«**
   - GUI ç•Œé¢è®“ä½¿ç”¨è€…æ–°å¢/ç·¨è¼¯ Regex è¦å‰‡
   - ä¾‹å¦‚ï¼šã€Œå°ç©é›»ã€å¸¸è¢«è¾¨è­˜ç‚ºã€Œå°jÄ«é›»ã€ï¼ŒåŠ å…¥è‡ªå‹•ä¿®æ­£

4. **èªéŸ³æŒ‡ä»¤**
   - è¾¨è­˜çµæœä¸­åŒ…å«ç‰¹æ®ŠæŒ‡ä»¤æ™‚åŸ·è¡Œå‹•ä½œ
   - ä¾‹å¦‚ï¼šã€Œæ›è¡Œã€â†’ æ’å…¥ `\n`ï¼Œã€Œå…¨å½¢å¥è™Ÿã€â†’ `ã€‚`

5. **å¤šæ®µéŒ„éŸ³æ‹¼æ¥**
   - æŒ‰ä¸€æ¬¡ F1 é–‹å§‹ï¼Œå†æŒ‰ä¸€æ¬¡ F1 æš«åœï¼ˆä¸é€ APIï¼‰
   - å†æŒ‰ä¸€æ¬¡ç¹¼çºŒï¼Œæœ€å¾Œé•·æŒ‰ 2 ç§’çµæŸä¸¦é€ API
   - é©åˆé•·ç¯‡æ–‡ç« éŒ„éŸ³

6. **OCR çµåˆ**
   - å¿«æ·éµæˆªåœ– + OCR æ–‡å­—è¾¨è­˜
   - èˆ‡èªéŸ³è¾¨è­˜æ•´åˆæˆã€Œå¤šæ¨¡æ…‹è¼¸å…¥ã€

---

## åã€æˆæ¬Šèˆ‡å…è²¬è²æ˜

- æœ¬æ–‡ä»¶æä¾›çš„æŠ€è¡“ç´°ç¯€èˆ‡ç¨‹å¼ç¢¼åƒ…ä¾›å­¸ç¿’èˆ‡å€‹äººä½¿ç”¨
- OpenAI Whisper API ä½¿ç”¨éœ€éµå®ˆ OpenAI æœå‹™æ¢æ¬¾
- AutoHotkey å’Œ Python ç›¸é—œå¥—ä»¶å„æœ‰å…¶é–‹æºæˆæ¬Šï¼Œè«‹éµå®ˆ
- ç¨‹å¼ä½¿ç”¨è€…éœ€è‡ªè¡Œè² è²¬éº¥å…‹é¢¨æ¬Šé™ã€ç¶²è·¯å®‰å…¨ç­‰è²¬ä»»
- ä½œè€…ä¸å°ä»»ä½•å› ä½¿ç”¨æœ¬æ–‡ä»¶è€Œç”¢ç”Ÿçš„æå¤±è² è²¬

---

**æ–‡ä»¶çµæŸ â€” ç¥å¯¦ä½œé †åˆ©ï¼ğŸš€**
